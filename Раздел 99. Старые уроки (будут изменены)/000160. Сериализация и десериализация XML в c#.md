Сериализация и десериализация XML в c#||wmysterio|wmysterio|wmysterio@yandex.ru|||Доброго времени суток всем пользователям нашего сайта! Сегодня мы изучим одну важную тему как сериализация и обратный её процесс - десириализация. Под этим странным словом "сериализация" скрывается процесс перевода некой информации в поток битов с целью сохранить где-то или восстановить из чего-то. Иными словами - изъять из файла объект или сохранить объект в файл. Для примера мы будем использовать XML-файл для хранения нашего субъекта. Сам объект будет представлен следующим классом, например:<br> <div class="bbCodeBlock"><div class="bbCodeName" style="padding-left:5px;font-weight:bold;font-size:7pt"><font class="code">Код</font></div><div class="codeMessage" style="border:1px inset;max-height:200px;overflow:auto;height:expression(this.scrollHeight<5?this.style.height:scrollHeight>200?'200px':''+(this.scrollHeight+5)+'px');"><font class="code">public class Car {<br></font><font class="code"><font class="code">&nbsp;&nbsp;&nbsp; </font>public float Speed;<br></font><font class="code"><font class="code">&nbsp;&nbsp;&nbsp; </font>public string EngineType;<br></font><font class="code"><font class="code">&nbsp;&nbsp;&nbsp; </font>public int SeatCount;<br><br></font><font class="code"><font class="code">&nbsp;&nbsp;&nbsp; </font>public Car() { }<br>}</font></div></div> Чтобы удобно работать с таким средством, как сериализация, Нам лучше создать ещё один класс, который будет выполнять поставленную задачу. К примеру, назовём его "XMLFile". Чтобы он умел работать со всеми типами данных, ему нужно указать приставку с типом данных на вход:<br> <div class="bbCodeBlock"><div class="bbCodeName" style="padding-left:5px;font-weight:bold;font-size:7pt"><font class="code">Код</font></div><div class="codeMessage" style="border:1px inset;max-height:200px;overflow:auto;height:expression(this.scrollHeight<5?this.style.height:scrollHeight>200?'200px':''+(this.scrollHeight+5)+'px');"><font class="code">public class XMLFile**<font color="#0000cd">&lt;T&gt;</font>** {<br><br>}</font><font class="code"></font></div></div> Как правило неизвестный тип(или ожидаемый) принято называть как <font class="code">**<font color="#0000cd">T</font>**</font>, хотя это никак не влияет общую картину. Так как этот тип нам нужно использовать в методах, которые я запланировал, нам нужно создать поле со стандартным типом **Type**, переменная которой будет заполнятся из конструктора с помощью инструкции <font color="#0000cd">typeof</font>, которая как раз и возвращает тип переданного в неё объекта. Что Нам ещё нужно? Естественно - это путь к файлу, иначе куда/откуда будет записывать/читать класс. Наш конструктор будет иметь следующий вид:<br> <div class="bbCodeBlock"><div class="bbCodeName" style="padding-left:5px;font-weight:bold;font-size:7pt"><font class="code">Код</font></div><div class="codeMessage" style="border:1px inset;max-height:200px;overflow:auto;height:expression(this.scrollHeight<5?this.style.height:scrollHeight>200?'200px':''+(this.scrollHeight+5)+'px');"><font class="code">public class XMLFile**<font color="#0000cd">&lt;T&gt;</font>** {<br></font><font class="code"><font class="code">&nbsp;&nbsp; </font>Type dataType;<br></font><font class="code"><font class="code">&nbsp;&nbsp; </font>string filePath;<br><br></font><font class="code"><font class="code">&nbsp;&nbsp; </font>public XMLFile( string filePath ) {<br></font><font class="code"><font class="code">&nbsp;&nbsp; </font></font><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font>this.filePath = filePath + ".xml";<br></font><font class="code"><font class="code">&nbsp;&nbsp; </font></font><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font>dataType = typeof( T );<br>&nbsp;&nbsp; }<br>}</font></div></div> Дальше нам нужно написать две процедуры, которые сериализуют и десириализуют объект соответственно. Первый метод назовём - **Load()**, который десериализует данные из файла и вернёт объект указанного в конструкторе типа.<br><br>Стандартный класс **XmlSerializer **может получать данные только с потоковыми типами данных, например TextReader или TextWriter, по-этому мы должны создать объект потоковых типов а затем сам десериалайзер:<br> <div class="bbCodeBlock"><div class="bbCodeName" style="padding-left:5px;font-weight:bold;font-size:7pt"><font class="code">Код</font></div><div class="codeMessage" style="border:1px inset;max-height:200px;overflow:auto;height:expression(this.scrollHeight<5?this.style.height:scrollHeight>200?'200px':''+(this.scrollHeight+5)+'px');"><font class="code">TextReader tr = new StreamReader( filePath ); <font color="#006400">// открываем поток</font><br>XmlSerializer reader = new XmlSerializer( dataType ); <font color="#006400">// передаём тип T в качестве параметра</font><br></font><font class="code"></font></div></div> Следующим щагом будет создания объекта типа <font class="code">**<font color="#0000cd">T</font>**</font> и возврат его из метода. Делается это следующим образом:<br> <div class="bbCodeBlock"><div class="bbCodeName" style="padding-left:5px;font-weight:bold;font-size:7pt"><font class="code">Код</font></div><div class="codeMessage" style="border:1px inset;max-height:200px;overflow:auto;height:expression(this.scrollHeight<5?this.style.height:scrollHeight>200?'200px':''+(this.scrollHeight+5)+'px');"><font class="code">reader.Deserialize( tr );<br></font></div></div> Как только данные изъяты нам нужно преобразовать его к типу <font class="code">**<font color="#0000cd">T</font>**</font>, чтобы наш c# умел с ним обращаться. Наш метод будет таков:<br> <div class="bbCodeBlock"><div class="bbCodeName" style="padding-left:5px;font-weight:bold;font-size:7pt"><font class="code">Код</font></div><div class="codeMessage" style="border:1px inset;max-height:200px;overflow:auto;height:expression(this.scrollHeight<5?this.style.height:scrollHeight>200?'200px':''+(this.scrollHeight+5)+'px');"><font class="code">public **<font color="#0000cd">T</font>** Load() {<br></font><font class="code"><font class="code">&nbsp;&nbsp; </font>TextReader tr = new StreamReader( filePath );<br></font><font class="code"><font class="code">&nbsp;&nbsp; </font>XmlSerializer reader = new XmlSerializer( dataType );<br></font><font class="code"><font class="code">&nbsp;&nbsp;&nbsp;</font></font><font class="code"><font class="code">**<font color="#0000cd">T</font>**</font> **instance** = (</font><font class="code"><font class="code">**<font color="#0000cd"> T</font>**</font> ) reader.Deserialize( tr );<br></font><font class="code"><font class="code">&nbsp;&nbsp; </font>tr.Close(); <font color="#006400">// обязательно нужно закрывать файловый поток!</font><br></font><font class="code"><font class="code">&nbsp;&nbsp; </font>return </font><font class="code"><font class="code">**instance**</font>;<br>}<br></font></div></div> Сохранение происходит несколько иным образом, но за похожим принципом. Во-первых: нужно знать объект, который нужно сохранить, по-этому передаём его в качестве параметра процедуры через ключевое слово <font color="#0000cd">object</font>. Во-вторых: в качестве файлового потока используем <font class="code">TextWriter, так как мы должны записывать данные.&nbsp;</font> Для сериализации используем следующий код:<br> <div class="bbCodeBlock"><div class="bbCodeName" style="padding-left:5px;font-weight:bold;font-size:7pt"><font class="code">Код</font></div><div class="codeMessage" style="border:1px inset;max-height:200px;overflow:auto;height:expression(this.scrollHeight<5?this.style.height:scrollHeight>200?'200px':''+(this.scrollHeight+5)+'px');"><font class="code">public void Save( <font color="#0000cd">object Obj</font> ) {<br></font><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font>TextWriter tw = new StreamWriter( filePath );<br></font><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font>XmlSerializer writer = new XmlSerializer( dataType );<br></font><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font>writer.Serialize( tw, **Obj** );<br></font><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font>tw.Close();<br>}</font><font class="code"><br></font></div></div> <font color="#ff0000">Важно!</font> Как уже было сказано, сериализация происходит только с публичными полями. Это значит, что все методы и приватные поля не будут входить в сохраняемый объект.<br><br>Наш класс XMLFile иметь такое содержание:<br> <div class="bbCodeBlock"><div class="bbCodeName" style="padding-left:5px;font-weight:bold;font-size:7pt"><font class="code">Код</font></div><div class="codeMessage" style="border:1px inset;max-height:200px;overflow:auto;height:expression(this.scrollHeight<5?this.style.height:scrollHeight>200?'200px':''+(this.scrollHeight+5)+'px');"><font class="code">public class XMLFile&lt;T&gt; {<br></font><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font>Type dataType;<br></font><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font>string filePath;<br><br></font><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font>public XMLFile( string filePath ) {<br></font><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font></font></font></font>this.filePath = filePath + ".xml";<br></font><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font></font></font></font>dataType = typeof( T );<br></font><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font>}<br><br></font><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font>public T Load() {<br></font><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font></font></font></font>TextReader tr = new StreamReader( filePath );<br></font><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font></font></font></font>XmlSerializer reader = new XmlSerializer( dataType );<br></font><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font></font></font></font>T instance = (T) reader.Deserialize( tr );<br></font><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font></font></font></font>tr.Close();<br></font><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font></font></font></font>return instance;<br></font><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font>}<br><br></font><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font>public void Save( object Obj ) {<br></font><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font></font></font>TextWriter tw = new StreamWriter( filePath );<br></font><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font></font></font></font>XmlSerializer writer = new XmlSerializer( dataType );<br></font><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font></font></font></font>writer.Serialize( tw, Obj );<br></font><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font></font></font></font>tw.Close();<br></font><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font>}<br><br>}</font><font class="code"><br></font></div></div> Давайте проверим рабоспособность нашего класса. Для этого создадим объект класса Car, который мы написали выше и сохраним его. Наш код будет следующим:<br> <div class="bbCodeBlock"><div class="bbCodeName" style="padding-left:5px;font-weight:bold;font-size:7pt"><font class="code">Код</font></div><div class="codeMessage" style="border:1px inset;max-height:200px;overflow:auto;height:expression(this.scrollHeight<5?this.style.height:scrollHeight>200?'200px':''+(this.scrollHeight+5)+'px');"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font></font>static void Main( string[] args ) {<br></font><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font></font></font></font></font>XMLFile&lt;Car&gt; file = new XMLFile&lt;Car&gt;( "save" ); // создаём объект.<br><br></font><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font></font></font></font></font>Car c = new Car(); // создаём авто и заполняем поля объекта<br></font><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font></font></font></font></font>c.EngineType = "auto";<br></font><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font></font></font></font></font>c.SeatCount = 4;<br></font><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font></font></font></font></font>c.Speed = 25.0f;<br><br></font><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font></font></font></font></font>file.Save( c ); // сохраняем транспорт<br></font><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font></font>}<br></font></div></div> Проверяем результат:<br><!--IMG1--><a href="/_pu/2/06072255.png" class="ulightbox" target="_blank" title="Нажмите, для просмотра в полном размере..."><img alt="" src="/_pu/2/s06072255.jpg" /></a><!--IMG1--><br><br>Как мы видим - наш файл преобразовал некое дерево (как обычный xml-документ). Атрибуты "<font color="#ff0000">xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"</font>" можно удалить. Они никак не будут влиять на чтение объекта. Это чтение мы сейчас сделаем, используя следующий код:<br> <div class="bbCodeBlock"><div class="bbCodeName" style="padding-left:5px;font-weight:bold;font-size:7pt"><font class="code">Код</font></div><div class="codeMessage" style="border:1px inset;max-height:200px;overflow:auto;height:expression(this.scrollHeight<5?this.style.height:scrollHeight>200?'200px':''+(this.scrollHeight+5)+'px');"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font></font></font>static void Main( string[] args ) {<br></font></font></font></font></font></font><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font></font></font></font></font></font>XMLFile&lt;Car&gt; file = new XMLFile&lt;Car&gt;( "save" );<br></font></font></font></font></font></font><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font></font></font></font></font></font>Car c = file.Load();<font color="#006400"> // получаем объект из файла<br></font></font></font></font></font></font></font><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font color="#006400"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; // </font></font></font></font></font></font></font>и выводим информацию об объекте<br><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font></font></font></font></font></font>Console.WriteLine( "Engine: {0}&#92;nSeat count: {1}&#92;nMax. speed: {2}", c.EngineType, c.SeatCount, c.Speed );<br></font></font></font></font></font></font><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font></font></font></font></font></font>Console.ReadKey();<br></font></font></font></font></font></font><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code"><font class="code">&nbsp;&nbsp; </font></font></font></font></font></font>}</font></font></font></font></font></font><font class="code"><br></font></div></div> Результат:<br><!--IMG2--><img alt="" src="/_pu/2/32790903.png" /><!--IMG2--><br><br>Дальше в уроке пойдёт речь о некоторых особенностях заполнения xml-документа. В первую очередь это касается списков и массивов. Если наш класс Car будет иметь поле<br> <div class="bbCodeBlock"><div class="bbCodeName" style="padding-left:5px;font-weight:bold;font-size:7pt"><font class="code">Код</font></div><div class="codeMessage" style="border:1px inset;max-height:200px;overflow:auto;height:expression(this.scrollHeight<5?this.style.height:scrollHeight>200?'200px':''+(this.scrollHeight+5)+'px');"><font class="code">public List&lt;string&gt; Author;<br></font></div></div> то в таком формате нужно указывать тип, который указан в скобках:<br> <div class="bbCodeBlock"><div class="bbCodeName" style="padding-left:5px;font-weight:bold;font-size:7pt"><font class="code">Код</font></div><div class="codeMessage" style="border:1px inset;max-height:200px;overflow:auto;height:expression(this.scrollHeight<5?this.style.height:scrollHeight>200?'200px':''+(this.scrollHeight+5)+'px');"><font class="code"><!--?xml version="1.0" encoding="utf-8"?-->&lt;Car&gt;<br>**&nbsp; &lt;Author&gt;<br>&nbsp;&nbsp;&nbsp; &lt;string&gt;Joe MC Dolls&lt;/string&gt;<br>&nbsp;&nbsp;&nbsp; &lt;string&gt;El Bolder&lt;/string&gt;<br>&nbsp;&nbsp;&nbsp; &lt;string&gt;Mac Todds&lt;/string&gt;<br>&nbsp;&nbsp;&nbsp; &lt;string&gt;Jeck Petterson&lt;/string&gt;<br>&nbsp;&nbsp;&nbsp; &lt;string&gt;Yang Jedd&lt;/string&gt;<br>&nbsp;&nbsp;&nbsp; &lt;string&gt;Poly Ennson&lt;/string&gt;<br>&nbsp; &lt;/Author&gt;**<br>&nbsp; &lt;Speed&gt;25&lt;/Speed&gt;<br>&nbsp; &lt;EngineType&gt;auto&lt;/EngineType&gt;<br>&nbsp; &lt;SeatCount&gt;4&lt;/SeatCount&gt;<br>&lt;/Car&gt;<br></font></div></div> Второй случай будет касаться массивов. Заполнение не отличаются от списков, но в качестве примера возьмём класс **Car**. Содержимое xml-файла с полем<br> <div class="bbCodeBlock"><div class="bbCodeName" style="padding-left:5px;font-weight:bold;font-size:7pt"><font class="code">Код</font></div><div class="codeMessage" style="border:1px inset;max-height:200px;overflow:auto;height:expression(this.scrollHeight<5?this.style.height:scrollHeight>200?'200px':''+(this.scrollHeight+5)+'px');"><font class="code">public Car[] Cars;<br></font></div></div> в классе, например **<font class="code">Test</font>**,будет таковым:<br> <div class="bbCodeBlock"><div class="bbCodeName" style="padding-left:5px;font-weight:bold;font-size:7pt"><font class="code">Код</font></div><div class="codeMessage" style="border:1px inset;max-height:200px;overflow:auto;height:expression(this.scrollHeight<5?this.style.height:scrollHeight>200?'200px':''+(this.scrollHeight+5)+'px');"><font class="code">&lt;Test&gt;<br>**&nbsp; &lt;Cars&gt;<br>&nbsp;&nbsp;&nbsp; &lt;Car&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Speed&gt;25&lt;/Speed&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;EngineType&gt;auto&lt;/EngineType&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;SeatCount&gt;4&lt;/SeatCount&gt;<br>&nbsp;&nbsp;&nbsp; &lt;/Car&gt;<br>&nbsp;&nbsp;&nbsp; &lt;Car&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Speed&gt;120&lt;/Speed&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;EngineType&gt;auto&lt;/EngineType&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;SeatCount&gt;2&lt;/SeatCount&gt;<br>&nbsp;&nbsp;&nbsp; &lt;/Car&gt;<br>&nbsp;&nbsp;&nbsp; &lt;Car&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Speed&gt;400&lt;/Speed&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;EngineType&gt;auto&lt;/EngineType&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;SeatCount&gt;1&lt;/SeatCount&gt;<br>&nbsp;&nbsp;&nbsp; &lt;/Car&gt;<br>&nbsp; &lt;/Cars&gt;**<br>&lt;/Test&gt;<br></font></div></div> Некоторые типы данный нельзя сохранить. Кроме этого, сложные двухмерные массивы или списки имеют другие конструкции. Например: поле<br> <div class="bbCodeBlock"><div class="bbCodeName" style="padding-left:5px;font-weight:bold;font-size:7pt"><font class="code">Код</font></div><div class="codeMessage" style="border:1px inset;max-height:200px;overflow:auto;height:expression(this.scrollHeight<5?this.style.height:scrollHeight>200?'200px':''+(this.scrollHeight+5)+'px');"><font class="code">public List&lt;List&lt;string&gt;&gt; Autors;</font></div></div> как правило заполняется следующим образом:<br> <div class="bbCodeBlock"><div class="bbCodeName" style="padding-left:5px;font-weight:bold;font-size:7pt"><font class="code">Код</font></div><div class="codeMessage" style="border:1px inset;max-height:200px;overflow:auto;height:expression(this.scrollHeight<5?this.style.height:scrollHeight>200?'200px':''+(this.scrollHeight+5)+'px');"><font class="code">&lt;Autors&gt;<br>&nbsp; &lt;ArrayOfString&gt;<br>&nbsp;&nbsp;&nbsp; &lt;string&gt;test 0 1&lt;/string&gt;<br>&nbsp;&nbsp;&nbsp; &lt;string&gt;test 0 2&lt;/string&gt;<br>&nbsp;&nbsp;&nbsp; &lt;string&gt;test 0 3&lt;/string&gt;<br>&nbsp; &lt;/ArrayOfString&gt;<br>&nbsp; &lt;ArrayOfString /&gt;<br>&nbsp; &nbsp; &lt;string&gt;test 1 1&lt;/string&gt;<br>&nbsp;&nbsp;&nbsp; &lt;string&gt;test 1 2&lt;/string&gt;<br>&nbsp;&nbsp;&nbsp; &lt;string&gt;test 1 3&lt;/string&gt;<br>&nbsp; &lt;ArrayOfString /&gt;<br>&lt;/Autors&gt;<br></font></div></div> По-этому, если Вы решились заполнить XML-файл вручную, то лучше сохранить заранее объект а выходной документ использовать в качестве примера для Вашего файла.<br><br>Ещё несколько слов о требованию игнорировать некие поля. Как правило игнорируются приватные поля а также те, которые не указаны в XML-файле. Вот простой пример:<br> <div class="bbCodeBlock"><div class="bbCodeName" style="padding-left:5px;font-weight:bold;font-size:7pt"><font class="code">Код</font></div><div class="codeMessage" style="border:1px inset;max-height:200px;overflow:auto;height:expression(this.scrollHeight<5?this.style.height:scrollHeight>200?'200px':''+(this.scrollHeight+5)+'px');"><font class="code">[XmlIgnore]<br>public Car Preview;<br>[XmlIgnore]<br>string Pattern;</font></div></div> <br>Нужно немного потренироваться, ничего сложного здесь нет. С Вами был wmysterio. До встречи в новых уроках.<br>|3685|1|0|06072255`png`900`146`400`64\|32790903`png`158`123\||serializacija_i_deserializacija_xml_v_c|1400678655