ООП в c# Часть 2 - Полиморфизм||wmysterio|wmysterio|wmysterio@yandex.ru|||Это вторая часть по ООП в c#. Что же ещё спрятано под этим интересным словом? Очень многое! Сегодня я хотел-бы поговорить о таком интересном явлении, как "Полиморфизм". В переводе это слово означает "Изменять форму". В программировании это значит, что объекту одного класса можно присвоить значения другого объекта класса, оба из которых находятся в одной иерархии. Возьмём иерархию из предыдущего урока:<table style="width: 100%; border-collapse: collapse;"><tbody><tr><td style="border-width: 1px; border-style: solid; border-color: #000000; letter-spacing: 0px; word-spacing: 0px;">&nbsp;&nbsp;&nbsp; public class Car {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public int Speed = 0;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public Car() { }<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void SetSpeed(int NewSpeed) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Speed = NewSpeed;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } <br>&nbsp;&nbsp;&nbsp; }<br><br>&nbsp;&nbsp;&nbsp; public class Lanborghini : Car{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public int DoorCount = 4;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public string EngineType = "Automatic";<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public Lanborghini() { }<br>&nbsp;&nbsp;&nbsp; }<br><br>&nbsp;&nbsp;&nbsp; public class Gallardo : Lanborghini {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public int EnginePower = 1500;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public int TireSize = 4;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public Gallardo() { }<br>&nbsp;&nbsp;&nbsp; }<br></td></tr></tbody></table>Теперь мы можем пользоваться следующими конструкторами:<table style="width: 100%; border-collapse: collapse;"><tbody><tr><td style="border-width: 1px; border-style: solid; border-color: #000000; letter-spacing: 0px; word-spacing: 0px;">Car MyCar0 = new Car();<br><font color="#006400">Car MyCar1 = new Lanborghini();<br>Car MyCar2 = new Gallardo();<br>Lanborghini MyLambo = new Gallardo();</font><br>Gallardo MyGallardo = new Gallardo();<br></td></tr></tbody></table>А так же присваивать объектам одного класса значения объектов других:<table style="width: 100%; border-collapse: collapse;"><tbody><tr><td style="border-width: 1px; border-style: solid; border-color: #000000; letter-spacing: 0px; word-spacing: 0px;">MyCar0 = MyCar1;<br>MyCar0 = MyCar2;<br><font color="#006400">MyCar0 = MyLambo;<br>MyCar0 = MyGallardo;</font><br>MyCar1 = MyCar0;<br>MyCar1 = MyCar2;<br><font color="#006400">MyCar1 = MyLambo;<br>MyCar1 = MyGallardo;</font><br>MyCar2 = MyCar0;<br>MyCar2 = MyCar1;<br><font color="#006400">MyCar2 = MyLambo;<br>MyCar2 = MyGallardo;<br>MyLambo = MyGallardo;</font><br></td></tr></tbody></table>Зелёным цветом я выделил процесс полиморфизма. При этом объект будет иметь только те команды, которые свойственны данному классу. То есть если в нас есть такой конструктор:<table style="width: 100%; border-collapse: collapse;"><tbody><tr><td style="border-width: 1px; border-style: solid; border-color: #000000; letter-spacing: 0px; word-spacing: 0px;">Car MyCar = new Lanborghini();<br></td></tr></tbody></table>То MyCar будет иметь только те команды, которые есть в классе Car. Если в Lanborghini имелись такие поля:<table style="width: 100%; border-collapse: collapse;"><tbody><tr><td style="border-width: 1px; border-style: solid; border-color: #000000; letter-spacing: 0px; word-spacing: 0px;">public int DoorCount = 4;<br>public string EngineType = "Automatic";<br></td></tr></tbody></table>То MyCar будет игнорировать их и выведет только эти:<br><!--IMG1--><img alt="" src="/_pu/1/49802526.png" /><!--IMG1--><br>Однако что будет, если воспользоваться таким конструктором:<table style="width: 100%; border-collapse: collapse;"><tbody><tr><td style="border-width: 1px; border-style: solid; border-color: #000000; letter-spacing: 0px; word-spacing: 0px;">Gallardo MyGallardo = new Car();<br></td></tr></tbody></table>?<br><br>Нам выведет ошибку: "Ошибка 1 Не удается неявно преобразовать тип<font color="#ff4500"> <font color="#ff0000">"Car"</font></font> в<font color="#ff0000"> "Gallardo"</font>. Существует явное преобразование". Давайте тогда преобразуем явно. Делается это, как уже звучало в ранних уроках, спомощью скобок перед выражением:<table style="width: 100%; border-collapse: collapse;"><tbody><tr><td style="border-width: 1px; border-style: solid; border-color: #000000; letter-spacing: 0px; word-spacing: 0px;">Gallardo MyGallardo = (Gallardo) new Car();<br><br>или так:<br><br>Gallardo MyGallardo = new Gallardo();<br>MyGallardo = (Gallardo)MyCar;<br></td></tr></tbody></table>Отлично! Никаких ошибок в компиляторе в нас уже не возникает. Давайте запустим консольное приложение из этого кода<table style="width: 100%; border-collapse: collapse;"><tbody><tr><td style="border-width: 1px; border-style: solid; border-color: #000000; letter-spacing: 0px; word-spacing: 0px;">static void Main() {<br>&nbsp;&nbsp;&nbsp; Car MyCar = new Lanborghini();<br>&nbsp;&nbsp;&nbsp; Gallardo MyGallardo = (Gallardo)MyCar ;<br>&nbsp;&nbsp;&nbsp; Console.ReadKey();<br>}<br></td></tr></tbody></table>что бы проверить на работоспособность программу и процесс преобразования. И опять у нас появилось исключение в таком страшном окне с сообщением: "Не удалось привести тип объекта <font color="#ff0000">"Consol.Lanborghini"</font> к типу <font color="#ff0000">"Consol.Gallardo"</font>.". Напрашивается один вывод: "Нельзя преобразовать объекты в другие, если они являются выше по иерархии, то есть нельзя преобразовать Потомка в Родителя или старше". Также нельзя преобразовать объекты, которые наследуются от одного родителя. Например, если добавить новый класс Porche:<table style="width: 100%; border-collapse: collapse;"><tbody><tr><td style="border-width: 1px; border-style: solid; border-color: #000000; letter-spacing: 0px; word-spacing: 0px;">&nbsp;&nbsp;&nbsp; public class Porshe : Car {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public int DoorCount = 2;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public string EngineType = "Automatic";<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public int WheelsSize = 5; <br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public Porshe() { }<br>&nbsp;&nbsp;&nbsp; }<br></td></tr></tbody></table>То преобразовать его в Lanborghini также не получится:<table style="width: 100%; border-collapse: collapse;"><tbody><tr><td style="letter-spacing: 0px; word-spacing: 0px; width: 40%; border-width: 1px; border-style: solid; border-color: #000000;"><font color="#ff0000">myLambo = (Lanborghini)myPorshe;<br>myPorshe = (Porshe)myLambo;</font><br></td><td style="letter-spacing: 0px; word-spacing: 0px; width: 60%; border-width: 1px; border-style: solid; border-color: #000000;">Сообщение компилятора: "Преобразование **НЕВОЗМОЖНО**", он даже не пытается преобразовать.<br></td></tr></tbody></table>Вот такая небольшая порция информации о полиморфизме. Я не стал особо углубляться, для скриптинга GTA 4 этого вполне достаточно.|804|1|0|49802526`png`217`157\||oop_v_c_chast_2_polimorfizm|1392798665