Списки в c#. Запуск нескольких скритов в GTA 4||wmysterio|wmysterio|wmysterio@yandex.ru|||Всем прива! Этот урок будет содержать в себе 2 темы. Одна тема общая как для программирования в c#, так и для скриптинга GTA 4 - это списки. Мы узнаем как создавать списки и рассмотрим некоторые примеры. Во второй части урока Вы узнаете как создать 2 скрипта для GTA 4 в одном файле.<br><br>Списки очень похожи на массивы. Они могут содержать данные только одного типа данных, могут обращаться к элементам по индексу, но главное их отличие - динамическое изменение. если массивы имеют фиксированную длину, то списки более универсальны - длина может быть любой. Как уже было сказано, списки могут обращаться к данным по индексу: записывать и читать, но это возможно только в том случаи, если элемент был записан ранее. Шаблоном для объявления списка можно считать этот вариант:<table style="width: 100%; border-collapse: collapse; border: 1px solid black;" width=""><tbody><tr><td style="border: 1px solid black; letter-spacing: 0px; word-spacing: 0px;">List&lt;<font color="#0000ff">int</font>&gt; <font color="#808000">MyList</font> = new List&lt;<font color="#0000ff">int</font>&gt;();<br></td></tr></tbody></table>Мы указываем класс List, который будет содержать значения типа <font color="#0000ff">int</font>, указанных в треугольных скобках. Имя списка пусть будет <font color="#808000">MyList</font>. Далее мы пользуемся конструктором, чтобы создать объект класса.<br><br>Так как списки динамичны, то и добавлять/удалять элементы можно также динамически. Чтобы добавить элемент нужно воспользоваться командой:<table style="width: 100%; border-collapse: collapse; border: 1px solid black;" width=""><tbody><tr><td style="border: 1px solid black; letter-spacing: 0px; word-spacing: 0px;">MyList.Add( 5 );<br></td></tr></tbody></table>Внутри скобок мы указываем сущность, что будет добавлена в список. Тип этой сущности должен соответствовать типу самого списка. В данном случаи было добавлено число типа <font color="#0000ff">int</font>.<br><br>Чтобы удалить из списка элемент, нужно воспользоваться командой:<table style="width: 100%; border-collapse: collapse; border: 1px solid black;" width=""><tbody><tr><td style="border: 1px solid black; letter-spacing: 0px; word-spacing: 0px;">MyList.Remove( 5 );<br></td></tr></tbody></table><font color="#ff0000">Важно!</font> Нужно указывать элемент, а не индекс! Чтобы удалить элемент по-индексу, нужно воспользоваться командой:<table style="width: 100%; border-collapse: collapse; border: 1px solid black;" width=""><tbody><tr><td style="border: 1px solid black; letter-spacing: 0px; word-spacing: 0px;">MyList.RemoveAt( 0 );<br></td></tr></tbody></table><font color="#ff0000">0</font> - это индекс существующего элемента. Таким образом из списка будет удалена пятёрка. Удалять также можно по диапазону. Для этого воспользуемся командой:<table style="width: 100%; border-collapse: collapse; border: 1px solid black;" width=""><tbody><tr><td style="border: 1px solid black; letter-spacing: 0px; word-spacing: 0px;">MyList.RemoveRange( 0, 1 );<br></td></tr></tbody></table>Здесь:<br><font color="#ff0000">0</font> - указываем начальную позицию(индекс);<br><font color="#ff0000">1</font> - количество элементов от индекса, которых нужно удалить из списка.<br><br>Чтобы удалить все элементы списка, достаточно выполнить процедуру очистки:<table style="width: 100%; border-collapse: collapse; border: 1px solid black;" width=""><tbody><tr><td style="border: 1px solid black; letter-spacing: 0px; word-spacing: 0px;">MyList.Clear();<br></td></tr></tbody></table>Чтобы проверить количество всех элементов достаточно воспользоваться командой:<table style="width: 100%; border-collapse: collapse; border: 1px solid black;" width=""><tbody><tr><td style="border: 1px solid black; letter-spacing: 0px; word-spacing: 0px;">int <font color="#0000ff">a</font> = MyList.Count;<br></td></tr></tbody></table>В переменную <font color="#0000ff">а</font> будет записано количество элементов в списке<br><br>Вставлять элементы можно также в указанную позицию:<table style="width: 100%; border-collapse: collapse; border: 1px solid black;" width=""><tbody><tr><td style="border: 1px solid black; letter-spacing: 0px; word-spacing: 0px;">MyList.Insert( 6, 15 );<br></td></tr></tbody></table>Здесь:<br><font color="#ff0000">6</font> - индекс в списке, куда нужно вставить элемент;<br><font color="#ff0000">15</font> - сам элемент.<br><br><font color="#ff0000">Важно!</font> Индекс всегда обязательно должен существовать. Иными словами на 6 позиции в списке уже должен существовать элемент. Исключением является индекс 0 - элементы будут помещаться в начало списка.<br><br>Также есть возможность конвертировать список в массив. Для этого можно воспользоваться процедурой:<table style="width: 100%; border-collapse: collapse; border: 1px solid black;" width=""><tbody><tr><td style="border: 1px solid black; letter-spacing: 0px; word-spacing: 0px;">int[] IntList = MyList.ToArray();<br></td></tr></tbody></table>Тип массива и тип списка должны совпадать. дальше с массивом можно делать всё что угодно.<br><br>Хотел бы рассказать об одной полезной возможности, которая есть во многих стандартный классах коллекций: поиск элемента в коллекции. Чтобы найти первый элемент вхождения нужно применить команду:<table style="width: 100%; border-collapse: collapse; border: 1px solid black;" width=""><tbody><tr><td style="border: 1px solid black; letter-spacing: 0px; word-spacing: 0px;">int q = MyList.IndexOf( 30 );<br></td></tr></tbody></table>Здесь:<br><font color="#ff0000">30</font> - это элемент, который нужно найти в списке.<br><font color="#0000ff">q</font> - в эту переменную будет возвращён <u>ИНДЕКС</u> первого вхождения. Если элемент не был найден, то в переменную будет возвращено число <font color="#ff0000">-1</font>.<br><br>Для поиска последнего вхождения элемента в список(последний индекс) нужно пользоваться:<table style="width: 100%; border-collapse: collapse; border: 1px solid black;" width=""><tbody><tr><td style="border: 1px solid black; letter-spacing: 0px; word-spacing: 0px;">int q = MyList.LastIndexOf( 30 );<br></td></tr></tbody></table>Для примера давайте создадим класс Car, который будет содержать одно свойство - скорость, пользователь будет вводить скорость для нового Car, которые будут помещены с список. После выполнения этих действий пользователю предложат найти Car, у которых будет скорость, введенная пользователем а также их количество:<!--uzcode--><div class="bbCodeBlock"><div class="bbCodeName" style="padding-left:5px;font-weight:bold;font-size:7pt">Код</div><div class="codeMessage" style="border:1px inset;max-height:200px;overflow:auto;height:expression(this.scrollHeight<5?this.style.height:scrollHeight>200?'200px':''+(this.scrollHeight+5)+'px');"><!--uzc-->using System;<br>using System.Collections.Generic;<br><br>namespace Consol {<br>&nbsp;&nbsp;&nbsp; class Program {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; static void Main() {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; List&lt;Car&gt; CarList = new List&lt;Car&gt;();<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.WriteLine( "Привет, введите скорость для 10 автомобилей&#92;n");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for(int i = 0; i &lt; 10; i++) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.Write("Введите скорость для автомобиля {0}: ", i);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CarList.Add( new Car( int.Parse( Console.ReadLine() ) ) );<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.Write( "&#92;nКакую скорость нужно искать? ");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int UserSpeed = int.Parse( Console.ReadLine() );<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int CountAuto = 0, tempIndex;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.Write( "&#92;nНомера транспорта с указанной скоростью:" );<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; foreach ( Car temp in CarList ) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ( temp.Speed == UserSpeed ) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tempIndex = CarList.IndexOf( temp );<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.Write( " {0}", ( tempIndex &gt; -1 ) ? tempIndex.ToString() : "" );<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CountAuto++;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.WriteLine(";&#92;n&#92;nКоличество транспорта с указанной скоростью: {0}", CountAuto);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.ReadKey();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; }<br><br>&nbsp;&nbsp;&nbsp; public class Car {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public int Speed { get; set; }<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public Car( int Speed ) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.Speed = Speed;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; }<br>}<!--/uzc--></div></div><!--/uzcode-->Тест программы:<br><!--IMG1--><img alt="" src="/_pu/2/85711019.png" /><!--IMG1--><br>Я специально взял список объектов класса, чтобы Вам было легче понять саму работу программы, потому что если взять объекты типа int, то возникнет сплошная путаница, как было со мной при изучении списков. Надеюсь вы сможете понять этот пример, так как списки встречаются и в скриптинге GTA 4.<br><br><font color="#ff0000">Важно!</font> Для работами со списками(коллекциями) необходимо подключить библиотеку:<table style="width: 100%; border-collapse: collapse; border: 1px solid black;" width=""><tbody><tr><td style="border: 1px solid black; letter-spacing: 0px; word-spacing: 0px;">using System.Collections.Generic;</td></tr></tbody></table><br>Вторая часть урока будет ближе к СкриптХуку и здесь я объясню как сделать два скрипта в одном файле. Как известно скрипт будет считаться скриптом только в том случаи, если класс наследуется от Script. Из этого можно сделать вывод, что следующий код будет запускать сразу 2 скрипта:<table style="width: 100%; border-collapse: collapse; border: 1px solid black;" width=""><tbody><tr><td style="border: 1px solid black; letter-spacing: 0px; word-spacing: 0px;">namespace TestScript {<br>&nbsp;&nbsp;&nbsp; public class Demo1 : Script {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public Demo1() {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp; }<br><br>&nbsp;&nbsp;&nbsp; public class Demo2 : Script {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public Demo2() {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; }<br>}<br></td></tr></tbody></table>Из этого можно провести аналогию, что <font color="#0000ff">namespace</font> - это главный поток **<font color="#006400">:MAIN</font>** из Sanny Builder, а Demo1 и Demo2 - созданные им потоки. Следовательно код выше можно сравнить с этим:<table style="width: 100%; border-collapse: collapse; border: 1px solid black;" width=""><tbody><tr><td style="border: 1px solid black; letter-spacing: 0px; word-spacing: 0px;">:MAIN<br>thread 'MAIN'<br>wait 0<br>// ...<br>// ...<br>// ...<br>create_thread @Demo1<br>create_thread @Demo2<br>end_thread<br><br>:Demo1<br>thread 'Demo1'<br>wait 0<br>end_thread<br><br>:Demo2<br>thread 'Demo2'<br>wait 0<br>end_thread<br></td></tr></tbody></table>Для полного сравнения напишем код для c# и Sanny Builder:<table style="width: 100%; border-collapse: collapse;"><tbody><tr><td style="width: 50%; vertical-align: top; border-width: 1px; border-style: solid; border-color: #000000; letter-spacing: 0px; word-spacing: 0px;" align="center">**c#**</td><td style="width: 50%; vertical-align: top; border-width: 1px; border-style: solid; border-color: #000000; letter-spacing: 0px; word-spacing: 0px;" align="center">** Sanny Builder**</td></tr><tr><td style="width: 50%; vertical-align: top; border-width: 1px; border-style: solid; border-color: #000000; letter-spacing: 0px; word-spacing: 0px;">namespace TestScript {<br><br>public class Demo1 : Script {<br><br>public Demo1() {<br>Wait( 2000 );<br>Player.Character.Money += 10000;<br>Game.DisplayText("Money gived");<br>}&nbsp;&nbsp;&nbsp; <br>}<br><br>public class Demo2 : Script {<br><br>public Demo2() {<br>Wait( 5000 );<br>Player.Character.Weapons.Uzi.Ammo = 500;<br>Game.DisplayText( "Ammo gived" );<br>}<br>}<br><br>}<br></td><td style="width: 50%; vertical-align: top; border-width: 1px; border-style: solid; border-color: #000000; letter-spacing: 0px; word-spacing: 0px;">:MAIN<br>thread 'MAIN'<br>wait 0<br>// ...<br>create_thread @Demo1<br>create_thread @Demo2<br>end_thread<br><br>:Demo1<br>thread 'Demo1'<br>wait 2000<br>Player.Money(0) += 10000<br>0ACE: show_formatted_text_box "Money gived"<br>end_thread<br><br>:Demo2<br>thread 'Demo2'<br>wait 5000<br>01B2: give_actor $PLAYER_ACTOR weapon 28 ammo 500<br>0ACE: show_formatted_text_box "Ammo gived"<br>end_thread<br></td></tr></tbody></table><br><font color="#ff0000">Внимание!</font> С этого момента уроки по c# разбиваются на 2 русла. Первой будет идти непосредственно по СкриптХуку, второе - по программировании в c#, которое я буду вести параллельно с остальными.<br><br>С Вами был wmysterio, пока!|1564|1|0|85711019`png`385`271\||spiski_v_c_zapusk_neskolkikh_skritov_v_gta_4|1392798730