# Опкоды. Типы проектов.

В предыдущей статье мы установили основной редактор для написания SCM-скриптов. Сейчас предлагаю ознакомиться с базовыми терминами, которые Вы встретите в любом случае. Начнём с понятия «Опкод». 

Под этим словом подразумевается некая команда, которую игра будет выполнять. За каждой командой закреплён персональный ID (уникальный идентификатор) и набор параметров, которые могут быть необходимы для правильного выполнения команды. Общая структура опкода в Sanny Builder представлена следующим образом:

```
YXXX: 0 1 2
```

Где `YXXX` — это число в шестнадцатеричной системе счисления[^1]. При этом `Y` может быть только числом `0` или `8`[^2]. А `0 1 2` — это параметры опкода. Количество параметров напрямую зависит от опкода. Их может быть несколько, они могут отсутствовать или не иметь фиксированного количества параметров.

Первый опкод, который важно рассмотреть, будет `0001: 1000`. Суть команды заключается в том, что он приостанавливает выполнение текущего скрипта на указанное время и передаёт управление другому скрипту. Параметр `1000` указывает минимальное количество времени, который скрипт будет в состоянии ожидания[^3].

Думаю, Вы заметили, что команда не имеет какого-либо описания. Я это сделал специально, так как не всё в строке опкода является параметром. Дело в том, что между параметрами обычно есть описание работы опкода. Без этих описаний читать скрипт было бы невероятно сложно. Для опкода `0001` описание обычно такое[^4]:

```
0001: wait 1000 ms
```

Я веду всё это к тому, что описание опкода никак не влияет на компиляцию[^5] и по сути является комментарием, который Sanny Builder игнорирует при сборке скрипта. Самое важное здесь — количество, тип и порядок параметров.

Если делать большой проект, то мы можем заметить, что некоторые команды встречаются очень часто. Настолько, что использование опкода становится неудобным. Для таких опкодов придумана система ключевых слов. Идея заключается в том, что компилятор Sanny Builder может самостоятельно распознать опкод без указания его ID. При этом описание становится ключевым словом, за которым следуют параметры:

```
wait 1000
```

Ключевые слова очень полезны, когда опкод имеет до 2-х параметров. Если их становится больше, то понять что за что отвечает весьма проблематично, так как в ключевых словах нет описания параметров[^6]. Значения и типы нужно заучивать. Этим пренебрегают некоторые плагины, которые добавляют ключевые слова с кучей параметров без явной необходимости. При открытии какого-либо файла, Sanny Builder вместо опкода будет использовать ключевые слова, как приоритет[^7].

Кроме ключевых слов, опкоды могут быть представлены другими сущностями, но о них будет отдельная статья. Пока это не так важно.

Следующий опкод, который важно рассмотреть, — это:

```
03A4: script_name 'MAIN'
// или ключевое слово
script_name 'MAIN'
```

В своей сути он указывает имя (уникальный ID) скрипта. Некоторые опкоды могут использовать это имя в различных целях. Сейчас я не буду описать эти опкоды (пока это не имеет значения), но нужно это иметь в виду. А Sanny Builder может использовать это имя для формирования названий меток[^8], что помогает при чтении кода в больших проектах (в визуальном плане).

Ввиду развития скриптинга и Sanny Builder, часть ключевых слов могут иметь синонимы. То есть за одно и тоже действие могут отвечать сразу несколько ключевых слов. К примеру опкод `03A4` кроме `script_name` имеет синоним:

```
thread 'MAIN' // то же, что и 03A4: script_name 'MAIN'
```

Оба варианта работают одинаково. В основном такие изменения происходят с целью сделать код похожим на тот, который использовали разработчики игры. При этом устаревшие названия ключевых слов сохраняются для обратной совиместимости[^9] со старыми скриптами, чтобы код, написанный условно 10 лет назад, мог компилироваться в современной версии SB.

## Типы проектов

Думаю, что нужно ещё рассказать о типах проектов, так как некоторые опкоды могут использоваться только в них. Сейчас существует два типа проектов в SB: «CLEO» и «main.scm».


Последние 2 опкода, которые мы рассмотрим в этом уроке, работают одинаково. Однако используются они в зависимости от типа проекта. Дайвате сейчас рассмотрим эти типы.




[^1]: Детали о [шестнадцатеричной системе счисления](https://ru.wikipedia.org/wiki/%D0%A8%D0%B5%D1%81%D1%82%D0%BD%D0%B0%D0%B4%D1%86%D0%B0%D1%82%D0%B5%D1%80%D0%B8%D1%87%D0%BD%D0%B0%D1%8F_%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BC%D0%B0_%D1%81%D1%87%D0%B8%D1%81%D0%BB%D0%B5%D0%BD%D0%B8%D1%8F).
[^2]: Есть причина, почему нужны только 0 или 8. Будет отдельная статья для этого.
[^3]: Минимальное время ожидания должно быть 0 или больше!
[^4]: Описание опкодов может изменяться в зависимости от версии Sanny Builder и CLEO-плагинов.
[^5]: О компиляции и всего остального будут отдельные статьи. Пока над этим не нужно заморачиваться.
[^6]: Требуется подтверждение.
[^7]: Процесс можно регулировать в настройках Sanny Builder.
[^8]: О метках будет отдельный урок.
[^9]: Детали про [обратную совместимость](https://ru.wikipedia.org/wiki/%D0%9E%D0%B1%D1%80%D0%B0%D1%82%D0%BD%D0%B0%D1%8F_%D1%81%D0%BE%D0%B2%D0%BC%D0%B5%D1%81%D1%82%D0%B8%D0%BC%D0%BE%D1%81%D1%82%D1%8C)
